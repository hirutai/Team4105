#include "Select.h"
#include "GameScene.h"
#include "Play.h"
#include "Title.h"
#include "../Input/KeyInput.h"
#include "../Tool/DebugJISText.h"
#include "../2D/Sprite.h"

XIIlib::Select::Select()
{
	// Initializeとほぼ同じ
}

XIIlib::Select::~Select()
{
	// ポインタ使ったやつの埋葬場
}

void XIIlib::Select::Initialize(GameScene* p_game_scene)
{
	// Scene切り替え時に一度通る処理
	easyButton.reset(Sprite::Create((UINT)SpriteName::EASY_BUTTON_SP, HOMEL_POS));
	normalButton.reset(Sprite::Create((UINT)SpriteName::NORMAL_BUTTON_SP, HOMEC_POS));
	hardButton.reset(Sprite::Create((UINT)SpriteName::HARD_BUTTON_SP, HOMER_POS));
	edge.reset(Sprite::Create((UINT)SpriteName::EDGE_SP, HOMEL_POS));
}

void XIIlib::Select::Update(GameScene* p_game_scene)
{
	
	if (gamePad_->Button_Down(X_A)) {
		p_game_scene->ChangeState(new Play);
	}
	// AかDを押してたら
	if (KeyInput::GetInstance()->Trigger(DIK_A) 
		|| KeyInput::GetInstance()->Trigger(DIK_D)) 
	{
		const float moveX = BASE_SIZE.x + GAP;
		
		if (KeyInput::GetInstance()->Trigger(DIK_A))
		{
			edgePos.x -= moveX;
		}
		else if (KeyInput::GetInstance()->Trigger(DIK_D))
		{
			edgePos.x += moveX;
		}
	}

	// 超えたら戻す
	if (edgePos.x <= HOMEL_POS.x)
	{
		edgePos.x = HOMEL_POS.x;
	}
	else if (edgePos.x >= HOMER_POS.x)
	{
		edgePos.x = HOMER_POS.x;
	}

	// 情報の更新
	edge->SetPosition(edgePos);

	// 更新
	if (KeyInput::GetInstance()->Trigger(DIK_SPACE)) {
		// ポジションによってステージナンバーを代入
		if (edgePos.x == HOMEL_POS.x)
		{
			stageNum = StageNumber::EASY;
		}
		else if (edgePos.x == HOMEC_POS.x)
		{
			stageNum = StageNumber::NORMAL;
		}
		else if (edgePos.x == HOMER_POS.x)
		{
			return;
			//stageNum = StageNumber::HARD;
		}
		p_game_scene->ChangeState(new Play);
	}
}

void XIIlib::Select::Draw()
{
	// 3D描画
}

void XIIlib::Select::DrawTex()
{
	// スプライト描画
	easyButton->Draw();
	normalButton->Draw();
	hardButton->Draw();
	edge->Draw();
}

void XIIlib::Select::DrawBackground()
{
}
